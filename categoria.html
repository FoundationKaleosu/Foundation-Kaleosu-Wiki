<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Categorias - Foundation Kaleosu Wiki</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      width: 100%;
      padding: 1rem;
      background-color: #20232a;
      border-bottom: 3px solid #daa520;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      flex-wrap: nowrap;
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
      font-weight: bold;
      flex: 1;
      min-width: 200px;
    }

    header div {
      display: flex;
      gap: 10px;
      flex-wrap: nowrap;
      justify-content: flex-end;
    }

    header button {
      background-color: #8b0000;
      color: #fff;
      border: 2px solid #daa520;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    header button:hover {
      background-color: #a22a2a;
    }

    main {
      flex: 1;
      padding: 6rem 1rem 2rem;
      display: flex;
      justify-content: center;
      flex-direction: column;
      align-items: center;
    }

    .categoria-container {
      background-color: #20232a;
      padding: 2rem;
      border-radius: 10px;
      border: 3px solid #daa520;
      width: 100%;
      max-width: 1100px;
      margin-bottom: 30px;
    }

    .categoria-container h2 {
      font-size: 2rem;
      color: #daa520;
      text-align: center;
      margin-bottom: 1rem;
    }

    .categoria-container input[type="text"] {
      width: calc(100% - 40px);
      padding: 10px;
      margin-bottom: 20px;
      background-color: #20232a;
      color: #fff;
      border: 2px solid #daa520;
      border-radius: 5px;
      font-size: 1rem;
    }

    .categoria-container button {
      flex: 1 1 auto;
      background-color: #8b0000;
      color: #fff;
      border: 2px solid #daa520;
      padding: 8px 12px;
      font-size: 0.85rem;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-right: 10px;
    }

    .categoria-container button:hover {
      background-color: #a22a2a;
    }

    .categoria-container .buttons-container {
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .categoria-lista-container {
      background-color: #20232a;
      padding: 2rem;
      border-radius: 10px;
      border: 3px solid #daa520;
      width: 100%;
      max-width: 1100px;
      margin-top: 30px;
    }

    .categoria-lista-container h2 {
      font-size: 2rem;
      color: #daa520;
      text-align: center;
      margin-bottom: 1rem;
    }

    .categoria-lista {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .categoria-card {
      background-color: #8b0000;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #daa520;
      text-align: center;
      cursor: pointer;
      transition: transform 0.3s, background-color 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 10px;
    }

    .categoria-card:hover {
      background-color: #8b0000;
      transform: scale(1.05);
    }

    .categoria-card span {
      color: #fff;
      font-size: 1.1rem;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }

      header div {
        flex-direction: row;
        justify-content: space-around;
        width: 100%;
        margin-top: 10px;
      }

      .categoria-container {
        padding: 1.5rem;
      }

      .categoria-container input[type="text"] {
        width: 100%;
      }

      .categoria-container button {
        width: 100%;
        margin: 5px 0;
      }

      .categoria-card {
        width: 100%;
        min-height: auto;
      }
    }
  </style>
</head>

<body>

<header>
  <h1>Foundation Kaleosu Wiki</h1>
  <div>
    <button onclick="irPara('index.html')">Início</button>
    <button onclick="irPara('categoria.html')">Categorias</button>
    <button onclick="irPara('sobre.html')">Sobre</button>
    <button onclick="irPara('contato.html')">Contato</button>
    <button onclick="abrirAreaRestrita('admin.html')">Área Restrita</button>
  </div>
</header>

<main>
  <!-- Container para Adicionar Categoria -->
  <div class="categoria-container">
    <h2>Gerenciar Categorias</h2>
    <input type="text" id="nomeCategoria" placeholder="Digite o nome da categoria">
    <input type="text" id="chaveMestra" placeholder="Digite a chave mestra">
    <div class="buttons-container">
      <button onclick="adicionarCategoria()">Adicionar Categoria</button>
      <button onclick="removerCategoria()">Remover Categoria</button>
    </div>
  </div>

  <!-- Container para Categorias Criadas -->
  <div class="categoria-lista-container">
    <h2>Lista de Categorias</h2>
    <div id="categoriaLista" class="categoria-lista"></div>
  </div>
</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getDatabase, ref, onValue, set, remove } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB2YB3DCEJ0TvoDsbLQw83yzqhSRG7i9GM",
    authDomain: "foundation-kaleosu-wiki.firebaseapp.com",
    databaseURL: "https://foundation-kaleosu-wiki-default-rtdb.firebaseio.com",
    projectId: "foundation-kaleosu-wiki",
    storageBucket: "foundation-kaleosu-wiki.appspot.com",
    messagingSenderId: "1026513810215",
    appId: "1:1026513810215:web:574eb84b7cc14c80c7af02"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const categoriaLista = document.getElementById("categoriaLista");
  const nomeCategoriaInput = document.getElementById("nomeCategoria");
  const chaveMestraInput = document.getElementById("chaveMestra");

  let categorias = [];

  function carregarCategorias() {
    onValue(ref(db, "categorias"), (snapshot) => {
      const data = snapshot.val();
      categorias = data ? Object.entries(data).map(([id, categoria]) => ({ id, ...categoria })) : [];
      exibirCategorias();
    });
  }

  function exibirCategorias() {
    categoriaLista.innerHTML = "";
    categorias.sort((a, b) => a.nome.localeCompare(b.nome));

    categorias.forEach(categoria => {
      const div = document.createElement("div");
      div.className = "categoria-card";
      div.innerHTML = `<span onclick="irParaCategoria('${categoria.id}')">${categoria.nome}</span>`;
      categoriaLista.appendChild(div);
    });
  }

  function adicionarCategoria() {
    const chaveMestra = chaveMestraInput.value;
    if (chaveMestra === "2025") {
      const nomeCategoria = nomeCategoriaInput.value.trim();
      if (nomeCategoria) {
        const novaCategoria = { nome: nomeCategoria };
        const categoriaRef = ref(db, "categorias/" + nomeCategoria);
        set(categoriaRef, novaCategoria)
          .then(() => {
            carregarCategorias();
            nomeCategoriaInput.value = "";
            chaveMestraInput.value = "";
          })
          .catch((error) => {
            alert("Erro ao adicionar categoria: " + error.message);
          });
      } else {
        alert("Digite o nome da categoria.");
      }
    } else {
      alert("Chave mestra incorreta.");
    }
  }

  function removerCategoria() {
    const chaveMestra = chaveMestraInput.value;
    if (chaveMestra === "2025") {
      const nomeCategoria = nomeCategoriaInput.value.trim();
      if (nomeCategoria) {
        const categoriaRef = ref(db, "categorias/" + nomeCategoria);
        remove(categoriaRef)
          .then(() => {
            carregarCategorias();
            nomeCategoriaInput.value = "";
            chaveMestraInput.value = "";
          })
          .catch((error) => {
            alert("Erro ao remover categoria: " + error.message);
          });
      } else {
        alert("Digite o nome da categoria.");
      }
    } else {
      alert("Chave mestra incorreta.");
    }
  }

  function irParaCategoria(id) {
    window.location.href = `categoria-detalhes.html?id=${id}`;
  }

  function irPara(url) {
    window.location.href = url;
  }

  function abrirAreaRestrita() {
    const senha = prompt("Digite a senha de acesso à Área Restrita:");
    if (senha === "2025") {
      window.location.href = "admin.html";
    } else {
      alert("Senha incorreta.");
    }
  }

  // Torna as funções acessíveis globalmente
  window.adicionarCategoria = adicionarCategoria;
  window.removerCategoria = removerCategoria;
  window.irPara = irPara;
  window.irParaCategoria = irParaCategoria;
  window.abrirAreaRestrita = abrirAreaRestrita;

  carregarCategorias();
</script>

</body>
</html>
